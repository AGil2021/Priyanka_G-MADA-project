---
title: "Example Manuscript Template for a Data Analysis Project"
subtitle: ""
author: Andreas Handel
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: article
output:
  bookdown::word_document2: 
    toc: false
    number_sections: true
  bookdown::html_document2: 
    toc: false
bibliography: ../references.bib
csl: ../apa.csl
---



```{r}



#Loading required packages
library(dplyr) #for data processing
library(here) #to set paths
library(tidyverse) #all required data manipulation packages

```


# Summary/Abstract
_Write a summary of your project._


# KEY QUESTIONS 

What is already known about this subject?

Residents of rural communities are at increased risk for severe COVID-19–associated morbidity and mortality. In September 2020, COVID-19 incidence (cases per 100,000 population) in rural counties surpassed that in urban counties.

What will this study add or answer?

The present analysis will attempt to estimate the percent of the population in each county that may be vaccine hesitant

Relationship between ethnicity and  vaccine hesitancy 

How might this impact clinical practice?

Identify and address barriers to COVID-19 vaccination in rural areas.


## General Background Information

Coronavirus disease (COVID-19) is an infectious disease caused by a newly discovered coronavirus. Coronavirus disease 2019 (COVID-19) was declared a pandemic in March 2020. COVID-19 vaccine is the most sustainable option to manage the current pandemic. However, vaccine hesitancy by even a small subset of the population can undermine the success of this strategy. 



## Description of data and data source
_Describe what the data is, what it contains, where it is from, etc. Eventually this might be part of a methods section._

The dataset used for this analysis is publicly available on CDC website. https://data.cdc.gov/Vaccinations/Vaccine-Hesitancy-for-COVID-19-County-and-local-es/q9mh-h2tw

The hesitancy rates at the county level using the Public Use Microdata Sample (PUMS). The data was collected by utilizing survey question, 
“Once a vaccine to prevent COVID-19 is available to you, would you…get a vaccine?”, which provides the following options:

1) “definitely get a vaccine”;
2) “probably get a vaccine”; 
3) “unsure”; 4) “probably not get a vaccine”; 
5) “definitely not get a vaccine.” 

We use three definitions to capture the strength of hesitancy to receive a vaccine.

Strongly hesitant: includes only survey responses indicating that they would “definitely not” receive a COVID-19 vaccine when available.

Hesitant: includes survey responses indicating that they would “probably not” or “definitely not” receive a COVID-19 vaccine when available.

Hesitant or unsure: includes survey responses indicating that they would “probably not” or “unsure” or “definitely not” receive a COVID-19 vaccine when available

## Questions/Hypotheses to be addressed
_State the research questions you plan to answer with this analysis._

The present analysis will attempt to estimate the percent of the population in each county that may be vaccine hesitant

Relationship between ethnicity and  vaccine hesitancy

# Future analysis

I plan to present a summary of county-wise vaccine estimate based on race and ethnicity. I will plot some graphs (box-plot, scatter plot). I am also planning to do some regression analysis too



# Methods and Results

_In most research papers, results and methods are separate. You can combine them here if you find it easier. You are also welcome to structure things such that those are separate sections._


## Data aquisition
_As applicable, explain where and how you got the data. If you directly import the data from an online source, you can combine this section with the next._

## Data import and cleaning
_Write code that reads in the file and cleans it so it's ready for analysis. Since this will be fairly long code for most datasets, it might be a good idea to have it in one or several R scripts. If that is the case, explain here briefly what kind of cleaning/processing you do, and provide more details and well documented code somewhere (e.g. as supplement in a paper). All materials, including files that contain code, should be commented well so everyone can follow along._
```{r}
library(readxl) #for loading Excel files
library(dplyr) #for data processing
library(here) #to set paths
library(tidyverse)

```


#path to data

```{r}
Covid_data_location <- here::here("data","raw_data","Vaccine_Hesitancy_for_COVID-19.xlsx")
```

#load data.

```{r}
rawdata <- readxl::read_excel(Covid_data_location)
```


#take a look at the data

```{r}
dplyr::glimpse(rawdata)


str(rawdata)


summary(rawdata)
```

#Data cleaning

##renaming Columns


```{r}
rawdata <- rawdata %>%
    rename(Hispanic = `Percent Hispanic`)

rawdata <- rawdata %>%
     rename(Asian = `Percent non-Hispanic Asian`)

 rawdata <- rawdata %>%
    rename(Black =`Percent non-Hispanic Black`)

 rawdata <- rawdata %>%
    rename(White ='Percent non-Hispanic White')
 
##Recoding Data
 
 
 rawdata <- rawdata %>%
    mutate(`SVI Category` = case_when(`SVI Category`=="Very Low Vulnerability" ~ 1,
                                      `SVI Category`=="Low Vulnerability" ~ 2,
                                      `SVI Category`=="Moderate Vulnerability" ~ 3,
                                      `SVI Category`=="High Vulnerability" ~ 4,
                                      `SVI Category`=="Very High Vulnerability" ~ 5))
 
 
 
 rawdata <- rawdata %>%
    mutate( `CVAC Level Of Concern` = case_when( `CVAC Level Of Concern`=="Very Low Concern" ~ 1,
                                                 `CVAC Level Of Concern`=="Low Concern" ~ 2,
                                                 `CVAC Level Of Concern`=="Moderate Concern" ~ 3,
                                                 `CVAC Level Of Concern`=="High Concern" ~ 4,
                                                 `CVAC Level Of Concern`=="Very High Concern" ~ 5))
 

```







##Creating new variables for Ease
```{r}
Northeast_state_data <- rawdata %>% dplyr::filter(State %in% c("MAINE", "NEW HAMPSHIRE", "VERMONT","MASSACHUSETTS","RHODE ISLAND","CONNECTICUT","NEW YORK","NEW JERSEY","PENNSYLVANIA" ))
 
## Cross_Check
Northeast_state_data 
 

Midwest_state_data <- rawdata %>% dplyr::filter(State %in% c("OHIO", "MICHIGAN", "INDIANA","WISCONSIN","ILLINOIS","MINNESOTA","IOWA","MISSOURI","NORTH DAKOTA","SOUTH DAKOTA","NEBRASKA","KANSAS" ))
 
## Cross_Check

Midwest_state_data 
 

South_state_data <- rawdata %>% dplyr::filter(State %in% c("DELAWARE", "MARYLAND", "VIRGINIA"," WEST VIRGINIA","KENTUCKY","NORTH CAROLINA","SOUTH CAROLINA","TENNESSEE","GEORGIA","FLORIDA","ALABAMA","MISSISSIPPI","Arkansas","LOUISIANA","TEXAS","OKLAHOMA","WASHINGTON"))


## Cross_Check
South_state_data
  

West_state_data <- rawdata %>% dplyr::filter(State %in% c("MONTANA", "IDAHO", "WYOMING"," COLORADO","NEW MEXICO","ARIZONA","UTAH","NEVADA","CALIFORNIA","OREGON","ALASKA","HAWAII"))

## Cross_Check

West_state_data

```


##BAR Charts
```{r}
B1 <- Northeast_state_data %>% ggplot(aes(x=`SVI Category`, fill=`SVI Category`)) + geom_bar() +
       labs(title= "Bar Chart of Frequency of Counties by SVI category (NOrtheast") + xlab("SVI CATEGORY") +  ylab("Count") + theme_classic()

print(B1)


B2 <- Midwest_state_data %>% ggplot(aes(x=`SVI Category`, fill=`SVI Category`)) + geom_bar() +
      labs(title= "Bar Chart of Frequency of Counties by SVI category (MIDWEST)") + xlab("SVI Category") +  ylab("Count") + theme_classic()


print(B2)


B3 <- West_state_data %>% ggplot(aes(x=`SVI Category`, fill=`SVI Category`)) + geom_bar() +
      labs(title= "Bar Chart of Frequency of Counties by SVI category (WEST)") + xlab("SVI Category") +  ylab("Count") + theme_classic()

print(B3)

B4 <- South_state_data %>% ggplot(aes(x=`SVI Category`, fill=`SVI Category`)) + geom_bar() +
    labs(title= "Bar Chart of Frequency of Counties by SVI category (SOUTH)") + xlab("SVI Category") +  ylab("Count") + theme_classic()

print(B4)
```



##SCatter plot between STATE and percent fully vaccinated

```{r}
p1 <- West_state_data %>% ggplot(aes(x= State, y=`Percent adults fully vaccinated against COVID-19 (as of 6/10/21)`)) + geom_point(color="red") + geom_smooth(method='lm', color="black") + labs(title= "Scatterplot of West vs  fully vaccinated", subtitle = ("All Counties,west")) + xlab("west STATES") +  ylab("Percent adults fully vaccinated") + theme_classic()

print(p1)

p2 <- Midwest_state_data %>% ggplot(aes(x= State, y=`Percent adults fully vaccinated against COVID-19 (as of 6/10/21)`)) + geom_point(color="blue") + geom_smooth(method='lm', color="black") + labs(title= "Scatterplot of Midwest vs  fully vaccinated", subtitle = ("All Counties, Midwest")) + xlab("Midwest STATES") +  ylab("Percent adults fully vaccinated") + theme_classic()

print(p2)


p3 <- South_state_data %>% ggplot(aes(x= State, y=`Percent adults fully vaccinated against COVID-19 (as of 6/10/21)`)) + geom_point(color="purple") + geom_smooth(method='lm', color="black") + labs(title= "Scatterplot of South states vs  fullyvaccinated", subtitle = ("All Counties, SOUTH")) + xlab("South STATES") +  ylab("Percent adults fully vaccinated") + theme_classic()


print(p3)

p4 <- Northeast_state_data %>% ggplot(aes(x= State, y=`Percent adults fully vaccinated against COVID-19 (as of 6/10/21)`)) + geom_point(color="green") + geom_smooth(method='lm', color="black") + labs(title= "Scatterplot of NOrtheast states vs  fullyvaccinated", subtitle = ("All Counties, NOrtheast")) + xlab("NORTHEAST STATES") +  ylab("Percent adults fully vaccinated") + theme_classic()

print(p4)
```
## Full analysis

_Use one or several suitable statistical/machine learning methods to analyze your data and to produce meaningful figures, tables, etc. This might again be code that is best placed in one or several separate R scripts that need to be well documented. You want the code to produce figures and data ready for display as tables, and save those. Then you load them here._

Example table \@ref(tab:resulttable) shows a table summarizing a linear model fit.

```{r resulttable,  echo=FALSE}
resulttable=readRDS("../../results/resulttable.rds")
knitr::kable(resulttable, caption = 'Linear model fit table.')
```


# Discussion

## Summary and Interpretation
_Summarize what you did, what you found and what it means._

## Strengths and Limitations
_Discuss what you perceive as strengths and limitations of your analysis._

## Conclusions
_What are the main take-home messages?_

_Include citations in your Rmd file using bibtex, the list of references will automatically be placed at the end_

This paper [@Leek2015a] discusses types of analyses. 

Note that this cited reference will show up at the end of the document, the reference formatting is determined by the CSL file specified in the YAML header. Many more style files for almost any journal [are available](https://www.zotero.org/styles). You also specify the location of your bibtex reference file in the YAML. You can call your reference file anything you like, I just used the generic word `references.bib` but giving it a more descriptive name is probably better.


# References



